import{k as h,l as b,n as v,c as y,d as _,f as x,j as p,p as A,g as D,b as F}from"./disclose-version.D3ZL7NP6.js";import{p as I,a as T,g as c}from"./runtime.DpG1UBjk.js";import{p as d}from"./main-client.3igdoS-M.js";import{F as U,u as $}from"./storage.BbWkkyvw.js";import{n as w}from"./Notifications.ym6NJcZe.js";var O=F('<span class="file-upload-dropzone svelte-gbcpcd" slot="labelText">Drag and drop map or other image here<br>(or click to upload)</span>');function W(l,i){T(i,!0);let m=h(i,["redirectOnAdd"]),r=b(d([]));async function f(e,a){const t={name:e,imageBlob:a},s=new Image;s.src=URL.createObjectURL(a),s.decode().then(()=>{t.width=s.naturalWidth,t.height=s.naturalHeight,$(t).then(([,o])=>{if(o===null){console.error(`Failed to add ${e}: ${t}`);return}w({title:"Image Added",subtitle:`Image "${o.name}" added (ID is ${o.id})`}),i.redirectOnAdd&&(window.location.href=c(r).length===1?`/view/?id=${o.id}`:"/dataset/"),p(r,d([]))})})}function g(e){if(!e.type||!e.type.startsWith("image/")){alert(`Only image files are accepted (file "${e.name}" rejected).`);return}f(e.name,e)}var n=A(l),u=_(n);U(u,v({multiple:!0,get files(){return c(r)},set files(e){p(r,d(e))}},()=>m,{$$events:{change:({detail:e})=>{e.forEach(a=>g(a))}},$$slots:{labelText:(e,a)=>{var t=D(e,!0,O);x(e,t)}}})),y(l,n),I()}export{W as A};
