import{f as h,n as b,c as v,d as y,k as _,q as x,l as A,b as D}from"./disclose-version.C3L7z7x-.js";import{c as F,p as $,a as I,g as p,s as c}from"./runtime.CsqbjnXD.js";import{p as d}from"./main-client.B0L5hVVe.js";import{b as T}from"./paths.D6INj-vC.js";import{u as U}from"./db.DVEEUmQX.js";import{n as w}from"./Notifications.6_IXH3UJ.js";import{F as O}from"./storage.CWIlOqU3.js";var k=D('<span class="file-upload-dropzone svelte-gbcpcd" slot="labelText">Drag and drop map or other image here<br>(or click to upload)</span>');function E(l,i){I(i,!0);let m=h(i,["redirectOnAdd"]),r=F(d([]));async function f(e,a){const t={name:e,imageBlob:a},s=new Image;s.src=URL.createObjectURL(a),s.decode().then(()=>{t.width=s.naturalWidth,t.height=s.naturalHeight,U(t).then(([,o])=>{if(o===null){console.error(`Failed to add ${e}: ${t}`);return}w({title:"Image Added",subtitle:`Image "${o.name}" added (ID is ${o.id})`}),i.redirectOnAdd&&(window.location.href=p(r).length===1?`${T}/view/?id=${o.id}`:"/dataset/"),c(r,d([]))})})}function u(e){if(!e.type||!e.type.startsWith("image/")){alert(`Only image files are accepted (file "${e.name}" rejected).`);return}f(e.name,e)}var n=x(l),g=y(n);O(g,b({multiple:!0,get files(){return p(r)},set files(e){c(r,d(e))}},()=>m,{$$events:{change:({detail:e})=>{e.forEach(a=>u(a))}},$$slots:{labelText:(e,a)=>{var t=A(e,!0,k);_(e,t)}}})),v(l,n),$()}export{E as A};
